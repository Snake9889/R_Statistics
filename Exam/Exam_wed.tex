% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\author{}
\date{\vspace{-2.5em}}

\begin{document}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{\textquotesingle{}d:}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{R\_Projects}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{Exam\textquotesingle{}}\NormalTok{) }
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Вячеслав\_Сергеевич\_Денисов.csv"}\NormalTok{, }\AttributeTok{encoding =} \StringTok{\textquotesingle{}UTF{-}8\textquotesingle{}}\NormalTok{, }\AttributeTok{sep =} \StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

Renaming colnames.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{=}\NormalTok{ df[}\FunctionTok{colnames}\NormalTok{(df) }\SpecialCharTok{!=} \StringTok{"X"}\NormalTok{] }
\FunctionTok{colnames}\NormalTok{(df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Algebra"}\NormalTok{, }\StringTok{"Geometry"}\NormalTok{, }\StringTok{"IT"}\NormalTok{, }\StringTok{"History"}\NormalTok{, }\StringTok{"Geography"}\NormalTok{, }\StringTok{"Economics"}\NormalTok{, }\StringTok{"Biology"}\NormalTok{, }\StringTok{"Physics"}\NormalTok{, }\StringTok{"Chemistry"}\NormalTok{, }\StringTok{"SocialScience"}\NormalTok{, }\StringTok{"Russian"}\NormalTok{, }\StringTok{"Literature"}\NormalTok{, }\StringTok{"PE"}\NormalTok{, }\StringTok{"PhysicalWork"}\NormalTok{, }\StringTok{"Music"}\NormalTok{, }\StringTok{"Arts"}\NormalTok{, }\StringTok{"English"}\NormalTok{, }\StringTok{"Region"}\NormalTok{, }\StringTok{"Salary"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

Defining ``Mean''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Mean }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1058}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{17}\NormalTok{) \{}
  \FunctionTok{print}\NormalTok{(i)}
\NormalTok{  df}\SpecialCharTok{$}\NormalTok{Mean }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Mean }\SpecialCharTok{+}\NormalTok{ df[i]}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10
## [1] 11
## [1] 12
## [1] 13
## [1] 14
## [1] 15
## [1] 16
## [1] 17
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Mean }\OtherTok{=}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Mean}\SpecialCharTok{/}\DecValTok{17}
\end{Highlighting}
\end{Shaded}

Salary\textasciitilde Mean corr.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{Mean }\OtherTok{=} \FunctionTok{unlist}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Mean)}
\FunctionTok{cor.test}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Mean, df}\SpecialCharTok{$}\NormalTok{Salary, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's product-moment correlation
## 
## data:  df$Mean and df$Salary
## t = 19.137, df = 1056, p-value < 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4612770 0.5508612
## sample estimates:
##      cor 
## 0.507439
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dummies)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## dummies-1.5.6 provided by Decision Patterns
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{=} \FunctionTok{dummy.data.frame}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in model.matrix.default(~x - 1, model.frame(~x - 1), contrasts = FALSE):
## non-list contrasts argument ignored
\end{verbatim}

Создаем dummies

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(df)[}\DecValTok{18}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"North"}\NormalTok{)}
\FunctionTok{names}\NormalTok{(df)[}\DecValTok{19}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"Center"}\NormalTok{)}
\FunctionTok{names}\NormalTok{(df)[}\DecValTok{20}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"South"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Forward with AIC Определите наиболее влияющие на зарплату предметы с
помощью (прямого и обратного) метода отбора переменных по (AIC/p-value)
для линейной регрессии. Отбор проводится по p-value.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_2 }\OtherTok{\textless{}{-}}\NormalTok{ df}
\NormalTok{subjects }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\NormalTok{min.aic }\OtherTok{=} \DecValTok{10000000}

\ControlFlowTok{while}\NormalTok{ (}\FunctionTok{ncol}\NormalTok{(df\_2) }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{)\{}
\NormalTok{  AIC.values }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\NormalTok{  aic }\OtherTok{=} \DecValTok{0}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(df\_2) }\SpecialCharTok{{-}} \DecValTok{5}\NormalTok{)) \{}
  
\NormalTok{    test.subj }\OtherTok{\textless{}{-}} \FunctionTok{append}\NormalTok{(subjects, }\FunctionTok{colnames}\NormalTok{(df\_2[i]))}
\NormalTok{    frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(test.subj, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{))) }
\NormalTok{    model.salary }\OtherTok{=} \FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df)}
\NormalTok{    AIC.values }\OtherTok{=} \FunctionTok{append}\NormalTok{(AIC.values, }\FunctionTok{AIC}\NormalTok{(model.salary))}
\NormalTok{    test.subj }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\NormalTok{  \}}
\NormalTok{  aic }\OtherTok{=} \FunctionTok{min}\NormalTok{(AIC.values)}
  \FunctionTok{print}\NormalTok{(aic)}
  \ControlFlowTok{if}\NormalTok{ (aic }\SpecialCharTok{\textless{}}\NormalTok{ min.aic)\{}
\NormalTok{    subjects }\OtherTok{=} \FunctionTok{append}\NormalTok{(subjects, }\FunctionTok{colnames}\NormalTok{(df\_2[}\FunctionTok{which.min}\NormalTok{(AIC.values)]))}
\NormalTok{    df\_2 }\OtherTok{=}\NormalTok{ df\_2[}\FunctionTok{colnames}\NormalTok{(df\_2) }\SpecialCharTok{!=} \FunctionTok{colnames}\NormalTok{(df\_2[}\FunctionTok{which.min}\NormalTok{(AIC.values)])]}
\NormalTok{    min.aic }\OtherTok{=}\NormalTok{ aic}
\NormalTok{  \}}
  \ControlFlowTok{else}\NormalTok{\{}
    \ControlFlowTok{break}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 22549.89
## [1] 22544.84
## [1] 22530.6
## [1] 22527.97
## [1] 22525.12
## [1] 22523.45
## [1] 22521.66
## [1] 22521.73
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = frmla, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -25227  -7117   -118   7000  32553 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 27005.95     645.76  41.820  < 2e-16 ***
## Algebra       181.47      26.34   6.888 9.71e-12 ***
## Chemistry      94.60      28.71   3.295 0.001018 ** 
## Economics     -91.70      25.94  -3.535 0.000425 ***
## Geometry       69.51      26.97   2.577 0.010090 *  
## PE            -59.85      26.35  -2.271 0.023363 *  
## Music          55.59      25.80   2.155 0.031413 *  
## Biology       -49.27      25.36  -1.943 0.052327 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10100 on 1050 degrees of freedom
## Multiple R-squared:  0.309,  Adjusted R-squared:  0.3044 
## F-statistic: 67.08 on 7 and 1050 DF,  p-value: < 2.2e-16
\end{verbatim}

Backward method with p-value.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subjects }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()  }
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(df) }\SpecialCharTok{{-}} \DecValTok{5}\NormalTok{)) \{}
\NormalTok{  subjects }\OtherTok{\textless{}{-}} \FunctionTok{append}\NormalTok{(subjects, }\FunctionTok{colnames}\NormalTok{(df[i]))  }
\NormalTok{\}}
\NormalTok{p }\OtherTok{=} \DecValTok{1}
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\NormalTok{model.salary }\OtherTok{=} \FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df))}\SpecialCharTok{$}\NormalTok{coefficients[,}\DecValTok{4}\NormalTok{]}

\ControlFlowTok{while}\NormalTok{ (p }\SpecialCharTok{\textgreater{}} \FloatTok{0.05}\NormalTok{)\{}
\NormalTok{  subjects }\OtherTok{=}\NormalTok{ subjects[}\SpecialCharTok{{-}}\NormalTok{(}\FunctionTok{which.max}\NormalTok{(model.salary) }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)]}
\NormalTok{  frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{))) }
\NormalTok{  model.salary }\OtherTok{=} \FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df))}\SpecialCharTok{$}\NormalTok{coefficients[,}\DecValTok{4}\NormalTok{]}
\NormalTok{  p }\OtherTok{=} \FunctionTok{max}\NormalTok{(model.salary) }
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\NormalTok{subjects\_true }\OtherTok{\textless{}{-}}\NormalTok{ subjects}
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = frmla, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -25217  -7223   -243   7198  32563 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 26988.97     644.47  41.878  < 2e-16 ***
## Algebra       182.59      25.72   7.100  2.3e-12 ***
## Geometry       71.18      26.35   2.701 0.007017 ** 
## Economics     -95.09      25.03  -3.799 0.000154 ***
## Chemistry      98.36      27.59   3.565 0.000380 ***
## PE            -56.62      25.78  -2.196 0.028288 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10120 on 1052 degrees of freedom
## Multiple R-squared:  0.3041, Adjusted R-squared:  0.3008 
## F-statistic: 91.95 on 5 and 1052 DF,  p-value: < 2.2e-16
\end{verbatim}

Checking F-criteria.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Algebra, }\AttributeTok{data =}\NormalTok{ df)) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Algebra, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -25119  -7277   -169   7447  32661 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 27186.520    631.158   43.07   <2e-16 ***
## df$Algebra    197.467      9.691   20.38   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10260 on 1056 degrees of freedom
## Multiple R-squared:  0.2822, Adjusted R-squared:  0.2815 
## F-statistic: 415.2 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Geometry, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Geometry, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -26219  -7460   -195   7879  33253 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 27845.703    643.730   43.26   <2e-16 ***
## df$Geometry   184.948      9.834   18.81   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10480 on 1056 degrees of freedom
## Multiple R-squared:  0.2509, Adjusted R-squared:  0.2502 
## F-statistic: 353.7 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Geography, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Geography, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -25549  -7512   -259   7534  33692 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  28261.924    654.411   43.19   <2e-16 ***
## df$Geography   176.403      9.938   17.75   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10630 on 1056 degrees of freedom
## Multiple R-squared:  0.2298, Adjusted R-squared:  0.2291 
## F-statistic: 315.1 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Biology, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Biology, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -27052  -7710   -407   7662  33982 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 28737.87     665.43   43.19   <2e-16 ***
## df$Biology    168.74      10.15   16.62   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10780 on 1056 degrees of freedom
## Multiple R-squared:  0.2073, Adjusted R-squared:  0.2065 
## F-statistic: 276.1 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Physics, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Physics, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -30366  -7466   -372   7922  33614 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 28385.370    651.659   43.56   <2e-16 ***
## df$Physics    175.947      9.975   17.64   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10640 on 1056 degrees of freedom
## Multiple R-squared:  0.2276, Adjusted R-squared:  0.2269 
## F-statistic: 311.2 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{Chemistry, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = df$Salary ~ df$Chemistry, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -28561  -7470   -448   7419  32986 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  27557.738    649.773   42.41   <2e-16 ***
## df$Chemistry   190.507      9.993   19.06   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10450 on 1056 degrees of freedom
## Multiple R-squared:  0.256,  Adjusted R-squared:  0.2553 
## F-statistic: 363.4 on 1 and 1056 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subjects }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()  }
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(df) }\SpecialCharTok{{-}} \DecValTok{5}\NormalTok{)) \{}
\NormalTok{  subjects }\OtherTok{\textless{}{-}} \FunctionTok{append}\NormalTok{(subjects, }\FunctionTok{colnames}\NormalTok{(df[i]))  }
\NormalTok{\}}
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\NormalTok{all.model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df)}

\NormalTok{maths }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Algebra"}\NormalTok{,}\StringTok{"Geometry"}\NormalTok{)}
\NormalTok{sciences }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Physics"}\NormalTok{, }\StringTok{"Geography"}\NormalTok{, }\StringTok{"Chemistry"}\NormalTok{, }\StringTok{"Biology"}\NormalTok{)}

\NormalTok{subjects }\OtherTok{=}\NormalTok{ subjects[ }\SpecialCharTok{{-}} \FunctionTok{which}\NormalTok{(subjects }\SpecialCharTok{\%in\%}\NormalTok{ maths)]}
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\NormalTok{math.model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df)}

\NormalTok{subjects }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()  }
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(df) }\SpecialCharTok{{-}} \DecValTok{5}\NormalTok{)) \{}
\NormalTok{  subjects }\OtherTok{\textless{}{-}} \FunctionTok{append}\NormalTok{(subjects, }\FunctionTok{colnames}\NormalTok{(df[i]))  }
\NormalTok{\}}
\NormalTok{subjects }\OtherTok{=}\NormalTok{ subjects[ }\SpecialCharTok{{-}} \FunctionTok{which}\NormalTok{(subjects }\SpecialCharTok{\%in\%}\NormalTok{ sciences)]}
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Salary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{)))}
\NormalTok{sciences.model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(frmla, }\AttributeTok{data =}\NormalTok{ df)}
\FunctionTok{anova}\NormalTok{(all.model, math.model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Model 1: Salary ~ Algebra + Geometry + IT + History + Geography + Economics + 
##     Biology + Physics + Chemistry + SocialScience + Russian + 
##     Literature + PE + PhysicalWork + Music + Arts + English
## Model 2: Salary ~ IT + History + Geography + Economics + Biology + Physics + 
##     Chemistry + SocialScience + Russian + Literature + PE + PhysicalWork + 
##     Music + Arts + English
##   Res.Df        RSS Df   Sum of Sq      F    Pr(>F)    
## 1   1040 1.0644e+11                                    
## 2   1042 1.1136e+11 -2 -4919827633 24.035 6.252e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{anova}\NormalTok{(all.model, sciences.model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Model 1: Salary ~ Algebra + Geometry + IT + History + Geography + Economics + 
##     Biology + Physics + Chemistry + SocialScience + Russian + 
##     Literature + PE + PhysicalWork + Music + Arts + English
## Model 2: Salary ~ Algebra + Geometry + IT + History + Economics + SocialScience + 
##     Russian + Literature + PE + PhysicalWork + Music + Arts + 
##     English
##   Res.Df        RSS Df   Sum of Sq      F  Pr(>F)  
## 1   1040 1.0644e+11                                
## 2   1044 1.0781e+11 -4 -1364681456 3.3334 0.01007 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Log regr.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i }\OtherTok{=} \DecValTok{0}
\NormalTok{df}\SpecialCharTok{$}\NormalTok{FTSalary }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1058}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{Salary)) \{}
  \ControlFlowTok{if}\NormalTok{ (df}\SpecialCharTok{$}\NormalTok{Salary[i] }\SpecialCharTok{\textgreater{}} \DecValTok{50000}\NormalTok{)\{}
\NormalTok{    df}\SpecialCharTok{$}\NormalTok{FTSalary[i] }\OtherTok{=} \DecValTok{1}  
\NormalTok{    \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{frmla }\OtherTok{=} \FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"FTSalary \textasciitilde{} "}\NormalTok{, }\FunctionTok{paste}\NormalTok{(subjects\_true, }\AttributeTok{collapse=}\StringTok{"+"}\NormalTok{))) }
\FunctionTok{summary}\NormalTok{(}\FunctionTok{glm}\NormalTok{(frmla, }\AttributeTok{family =} \StringTok{\textquotesingle{}gaussian\textquotesingle{}}\NormalTok{, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = frmla, family = "gaussian", data = df)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.39414  -0.23472  -0.10548   0.04123   1.07608  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.0462558  0.0225006  -2.056   0.0401 *  
## Algebra      0.0044667  0.0008979   4.975 7.63e-07 ***
## Geometry     0.0007316  0.0009199   0.795   0.4266    
## Economics   -0.0018637  0.0008740  -2.132   0.0332 *  
## Chemistry    0.0025097  0.0009633   2.605   0.0093 ** 
## PE          -0.0020032  0.0009001  -2.226   0.0263 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 0.124878)
## 
##     Null deviance: 150.03  on 1057  degrees of freedom
## Residual deviance: 131.37  on 1052  degrees of freedom
## AIC: 809.37
## 
## Number of Fisher Scoring iterations: 2
\end{verbatim}

\begin{verbatim}
\end{verbatim}

\end{document}
